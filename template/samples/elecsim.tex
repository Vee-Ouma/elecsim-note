
ElecSIM has been designed for ease of use to enable non-experts to rapidly test different policies and the outcome of various scenarios such as demand growth. The user is able to input exogenous variables such as fuel cost, carbon taxes, power plants, power plant costs, electricity demand and availability factors. This allows for the initialisation of different countries and scenarios to be tested.


\subsection{High-Level Overview}

\begin{figure}
	\centering
	\includegraphics[width=0.97\linewidth]{figures/System_overview}
	\caption{High level system overview demonstrating fundamental parts of ElecSIM.}
	\label{fig:systemoverview}
\end{figure}


\begin{table}[h]
	\centering
	\csvautobooktabular{tables/notation_formated.csv}
	\caption{Parameter notation.}
\end{table}


ElecSIM is made up of four fundamental parts: The agents, which are split up into demand and generation company (GenCo) agents. The world in which these agents exist. Power plants which are owned by the GenCo agents, and the Power Exchange which acts as a market to match GenCo owned power plants with electricity demand.

A schematic of ElecSIM is displayed in Figure \ref{fig:systemoverview} which shows these four fundamental parts, and how they interact.

\subsubsection{Data parametrisation} To parametrise the world two sources are used. A configuration file and data files. The data files store information such as historical fuel prices, historical plant availability, wind and solar capacity, power plant costs, historical costs, historical efficiency, company finances and historical carbon price. This is data that does not change from scenario to scenario for a country realisation, however does change between country and country.

To ensure rapid changes between scenarios, the configuration file enables the user to rapidly change scenarios, and points to the various previously mentioned data sources. The configuration file enables the changing of demand growth and load duration curve, which is the shape of demand curve over a year period. Future fuel and carbon prices, capital costs, plant availability, investment costs and simulation time. These data is then used to calibrate the world. 

The demand agent is a simplified representation of aggregated demand in a country. Each year it multiplies the percentage of change in demand with the load duration curve. This data is used by the Power Exchange to match supply with demand.

\subsection{Generation Companies} The GenCos have two main functions. Investing in power plants and making bids to sell their electricity yearly for each of their power plants. We will first focus on the buying and selling of electricity using a Power Exchange, and then cover the investment algorithm for GenCos.

\subsubsection{Electricity Market} \label{sssec:electricity_market} Figure \ref{fig:powermarket} displays the process for each segment of demand. The Power Exchange receives bids for every single power station in the modelled world from each of the GenCos. The final price paid to each of the GenCos is known as the spot price or the System Marginal Price (SMP). The spot price or SMP is the highest price that has been accepted to meet demand. This is paid to all generators regardless of their initial bid. For this reason, GenCos are motivated to bid their minimum profitable price to ensure that their bid is accepted. This minimum profitable price is known as the short run marginal cost (SRMC). The SRMC is the price that it costs a generator to sell a single unit of electricity. 

 

\begin{figure}
	\centering
	\includegraphics[width=1\linewidth]{figures/power_market}
	\caption{Power exchange clearing \cite{nuclear_economics_consulting_group_2019}.}
	\label{fig:powermarket}
\end{figure}

\subsubsection{Investment}

Investment in power plants is made upon a net present value (NPV) calculation. NPV is a summation of the present value of a series of present and future cash flow. NPV provides a method for evaluating and comparing investments with cash flows spread over many years, making it suited to evaluating power plants which have a long lifetime. NPV is based upon the fact that current cash flow is worth more than future cash flow. This is due to the fact that money today can be invested and have a rate of return in the future. Meaning that, for example \$50,000 today is worth more than \$50,000. 

Equation \ref{eq:npv_eq} displays the calculation of NPV. Where $t$ is the year of the cash flow. $i$ is the discount rate, $N$ is total number of periods, or lifetime of power plant, and $R_t$ is the net cash flow (cash inflow minus cash outflow) at time $t$.

\begin{equation} \label{eq:npv_eq}
NPV(i, N) = \sum_{t=0}^{N}\frac{R_t}{(1+t)^t}
\end{equation}

A discount rate set by a firm's weighted average cost of capital (WACC) is often used. Where WACC is the rate that a company is expected to pay on average for its stock and debt. However, it is often believed that a higher rate should be selected to adjust for differing risk profiles, opportunity cost and rate of return desired.

Data is available for average WACC for power plants, and can be set in the configuration file. However, to account for differing risk profiles, opportunity costs, rate of return desired, and WACC based on companies' relative credit risk, we have sampled difference in discount rates from the mean WACC with a Gaussian distribution with a standard deviation of $\pm3\%$. Which was chosen to give sufficient variance between GenCos whilst remaining close to the mean set by the user.

To calculate the expected return per year, an understanding of future market conditions is required. Future market conditions are dependent on demand and costs that would be incurred by the GenCo based upon each prospective investment. We simplify this calculation by forecasting a single year in the future, and assuming that this year is representative of each year of a power plant's lifetime.

As in the real world, GenCos have imperfect information, and therefore must forecast expected demand, fuel prices, carbon price and electricity sale price. This achieved by fitting functions to historical data. Each GenCo is different in that they will use differing historical time periods of data to forecast in the future. The distribution of this is configurable in the configuration file, referred to in Figure \ref{fig:systemoverview}.

Fuel price and carbon price is forecast using a linear regression. Demand, however, is first forecast using an exponential function, to take into account compounded growth. However, if a reasonable fit for historical demand data can not be found with optimisation linear regression is used.

These forecasted data is then used to simulate a market using the same electricity market algorithm that is detailed in Section \ref{sssec:electricity_market}. We simulate a market based on the expected bids -- based on SRMC -- that every operating power plant will make. This includes the removal of plants that will be past their life, and introduction of plants that are in construction or pre-development stages. 

However, there may be scenarios where demand is forecast to grow significantly, and limited investments have, at this point, been made to meet demand at the point in the future to be modelled. The expected price, would therefore be that of lost load. Where lost load is defined as the price customers would be willing to pay to avoid a disruption in their electricity supply. To avoid GenCos from predicting that large profits will be made, and under the assumption that further power plant investments will be made by other GenCos, the lost load price is replaced with a predicted electricity price using a linear regression based on prices at lower points of the demand curve. These prices are predicted using a linear regression. If zero segments of demand is met (high demand or low demand), then the lost load price is used to encourage significant investment.

Once expected fuel prices, carbon price, discount rate, and expected sale price of electricity are all forecasted, the NPV can be calculated. GenCos must typically provide a certain percentage of upfront capital, with the rest coming from investors in the form of stock and shares or debt (WACC). The percentage of upfront capital, or down payment, is set at $25\%$, but can be customised by the user in the configuration file. The GenCos then invest in the power plant with the highest NPV that they can afford with their cash, and this is repeated until they can no longer afford any more plants. We can reasonably make this assumption, as the NPV calculation provides information based upon which investments are worth more than money in a bank.

\subsection{Power Plant Parameter Estimation}

The estimation of power plant parameters is critical to electricity market models. Costs form an important element of markets and investment, and publicly available data for individual countries can be scarce. Thus, extrapolation and interpolation is required to estimate costs for power plants of differing sizes, types and years of construction.

Further information is required to fully parametrise power plants. Data such as availability and capacity and load factor. 



%GenCos  invest in power plants based on the highest positive net present value (NPV). Bids are made for each power plant based on the power plants short run marginal cost. A Power Exchange operator matches these bids with demand in merit order. 

This is then repeated for each year of the simulation.


%\begin{figure}[h]
%	\begin{center}
%		\includegraphics[width=0.5\textwidth]{figures/System_overview.pdf}
%		\caption{ElecSIM simulation overview.}
%		\label{fig:system_overview}
%	\end{center}
%\end{figure}

\begin{figure*}
	\centering
	\includegraphics[width=0.97\linewidth]{figures/low_level_system}
	\caption{ElecSIM simulation overview}
	\label{fig:lowlevelsystem}
\end{figure*}


\subsection{Detailed Overview}

ElecSIM is made up of two different agent types, GenCos (Generation Companies) and a Demand agent. GenCos can be initialised by the user. For example, to a desired country, or a toy-example. Each of the GenCos are initialised with their respective power plants. GenCos are given a randomized discount rate, which can be set by the user, around a mean of 10\% for nuclear power plants \cite{Paper2012} and 5.9\% for all other generators \cite{KPMG2017}.





\subsubsection{Data Initialisation}ElecSIM's power generation costs are initialised using the UK government Department for Business, Energy and Industrial Strategy (BEIS) power plant generation report \cite{Department2016}. This contains information such as capital costs and operation and maintenance costs ($F_C$ and $V_C$), including details such as insurance ($In_C$) and connection costs ($Con_C$). Where there are power plants of a size not included in this report, the parameters are linearly interpolated. Where the capacity of a power plant is larger or smaller than the data points in the report, the parameters are extrapolated by using the last known data point.

For historical power plants, we used historical costs of Levelised Cost of Energy (LCOE) \cite{Dale2013}. Each parameter was scaled linearly from the modern LCOE calculated from the BEIS report, to attain the relevant historical LCOE. This was achieved by using linear optimisation, and therefore each parameter can be changed based on an individual user's country and dataset by modifying the constraints. As well as historical LCOE, historical plant efficiency was taken into account for gas and coal power plants \cite{EIA2013}.

When initialised, the variable operation and maintenance costs are selected from a uniform distribution, with the ability for the user to set maximum and minimum percentage increase from the BEIS report. A uniform distribution was chosen to capture the large deviations that can occur in variation of variable operation and maintenance, especially other a long time period. By doing this, the variance in costs between individual power plants for processes such as preventative and corrective maintenance, labour costs and skill, health and safety and chance are different per plant.  

As per \cite{Chappin2017}, we created a load duration curve of the electricity demand for one year with 20 segments. 20 segments enabled us to capture the varying demand of electricity throughout a year to a high enough degree of accuracy, but also reduce computational complexity. To model the Intermittency of wind and solar power we allow them to contribute only a certain percentage of total capacity for each load segment based on empirical wind and solar capacity factors, relating demand to average capacity \cite{Pfenninger2016, Staffell2016, Chappin2017}. The requirement of storage to provide constant electricity from intermittent resources is an important issue. However, due to the fact that ElecSIM takes yearly time steps, we are unable to model short term variability in electricity demand. We also, do not model long-term storage due to its currently limited ability. 

Whilst fuel price is controlled by the user, there is inherent volatility in fuel price in a single year. To take into account this variability, an ARIMA model was fit to historical gas and coal price data \cite{coalprices,gasprices}. The standard deviation of the residuals was used to model the precise price of fuel that a generation company will buy the fuel in a given year. This takes into account differences in hedging strategies and the process of luck between competing generation companies.

Outages are modelled by using availability data of gas, coal, photovoltaic, offshore and onshore power generators \cite{Ltd2016, Hunt2015, carroll-j}. Plants bid a reduced percentage of their nameplate capacity based on their respective availability. Historical availabilities are modelled for older gas, coal and hydro power plants \cite{AlbertaSystemElectricOperator2016}.

With historical power plants which have been refurbished, we sample their initialisation randomly between 15 years prior to initialisation year and the initialisation year.

Power plants are taken out of service if they have not sold any electricity in the past 7 years. We decided upon this due to the fact that power generators have high, sunk capital costs, which often have high demolition costs. We assume, therefore, that generator companies are willing to wait circa $\frac{1}{4}$ of their lives to see if a pay-out occurs due to the breakdown of competing power plants, increasing demand, or governmental support in the form of a carbon tax increase or reduction.


\subsubsection{Spot Market}

The buying and selling of electricity is modelled as a spot market, where each year, electricity is bought and sold in merit order. GenCos place bids for each of their plants at the respective short run marginal cost. We assume that generator companies do not have market power, however we set the lost load to be \textsterling6000 to encourage investment as per the recommendations of the UK government \cite{DECC2013}.

\subsubsection{Investment}

Investments are made on a yearly basis and are made purely on net present value calculations. The order in which GenCos invest in each simulated year is randomised as to not give certain generation companies an advantage.

Agents have imperfect information, and therefore fuel and carbon prices are predicted using linear regression, with a training period sampled uniformly from the previous 3 to 7 years. This allows us to model heterogeneity of GenCos. Demand is modelled through the use of an exponential function, so that compounded growth can be modelled. However, if a reasonable fit for the training data is not found, a linear regression is used.

GenCos only bid if they have 25\% of the upfront capital costs, with the rest of the capital provided through equity and debt. The cost of equity and debt is modelled as a weighted average cost of capital (WACC), with values of 5.9\% for non-nuclear power plants, and 10\% for nuclear power plants \cite{KPMG2017, Paper2012}. The WACC is used as the discount rate for net present value calculations \cite{KincheloeStephenC1990TWAC}. Each GenCo is initialised with a slightly different discount rate based on a uniform distribution, with a $\pm$3\% standard deviation. This allows us to model the variability in discount rates that GenCos may have, based on different factors such as preference, risk strategies, and readiness for investors and lenders to supply capital.

The sale price of electricity in the future reference year is predicted by each generation company simulating the same merit-order market algorithm that is used for the spot market. They simulate the bids that they expect each of the power plants that are in operation to make, and use the demand predicted to match supply with demand. They then assess whether their investment option is likely to make a profit, ie. with a positive net present value. The power plant with the highest net present value is then invested in. 




%
%\begin{itemize}
%	\item Model can be modified through a single python scenario file which includes exogenous variables such as number of generation companies, power plants, power plant costs, tax and fuel prices, and demand.
%	\item Architectural framework:
%	\begin{itemize}
%		\item Agents are generation companies.
%		\item Generation companies initialized from government data. And randomized discount rate around a mean of 10\% for nuclear power plants and 5.9\% for other types of generators.
%		\item Costs of power plants taken from empirical data. 
%		\item Historical LCOE costs taken from data, with individual costs such as fixed operation and maintenance, construction and pre-development costs scaled linearly to match LCOE value. (This can be changed by user by specifying linear optimisation constraints).
%		\item Historical Gas turbine and Coal plant efficiency taken from epa data.
%		\item Variable operation and maintenance costs are stochastic to take into account differences in design types, preventative and corrective maintenance, labour costs and skill, asset and site management, health and safety and chance.
%		\item Electricity demand taken from historical data and split up into 19 load segments.
%		\item CO2 prices, fuel Prices, demand growth are exogenous
%		\item Fuel is bought by power producers each year at different prices, related to the standard deviation from historical data. This simulates different hedging strategies, luck and timing of fuel purchasing.
%		\item Outages are modelled by assuming a 93\% outage rate for fuel plants \cite{Ltd2016} and 97\% outage for renewables. \cite{carroll-j}
%		\item Generation companies bid their short run marginal costs.
%		\item Investments made on highest Net Present Value results. CO2 price, fuel price and demand are predicted 7 years ahead using linear regression. 
%		\item Estimated sale of electricity price calculated by simulating a market 7 years into the future with expected power plants that are running and have been taken out of service.
%		\item Investors will only invest if they have 25\% of the total upfront costs. (the rest taken on by debt and equity as assumed by WACC value.)
%		\item Intermittent power generators can only submit a certain percentage of their total capacity for each load segment. This percentage is matched with empirical data.
%		\item Bids accepted by a centralised Power Exchange based on merit order. Generation companies bid their short run marginal cost.
%	\end{itemize}
%	\item Assumptions: 
%	\begin{itemize}
%		\item Yearly time step
%		\item Renewables contribute to load curve of each demand segment matched with empirical data of typical wind and solar availability at each demand segment
%		\item Different discount rates per user (randomized)
%		\item Country initialized with full amount of power plants and generation companies in country and total demand data considered
%		\item No curtailment of renewables
%		\item Imperfect foresight - Prediction required for demand, co2 price, fuel cost, other investments.
%		\item Power plant construction and pre-development periods and costs modelled from UK Government BEIS data
%		\item Investments based on highest NPV using a single year 7 (can be changed in scenario file) time steps into the future to predict all years of power plant.
%		\item Agents predict next year's fuel, carbon and demand using linear regression and randomized look back period (between 3 and 6.)
%		\item Plants are dismantled after their lifetime, and only enter operation after pre-development/construction.
%		\item Legacy power plants are reinitialized to random starting year to account for refurbishment.
%		\end{itemize}
%\end{itemize}